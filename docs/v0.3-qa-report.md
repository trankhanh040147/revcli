# v0.3 QA Testing Report

**Date:** [Date]
**Tester:** [Name]
**Environment:** [OS, Terminal, Go version]
**Status:** [In Progress / Complete]

---

## 1. Code Block Highlighting & Navigation

### Code Block Detection
- [ ] Code blocks detected in initial review response
- [ ] Code blocks detected in chat follow-up responses
- [ ] Multiple code blocks in single response detected correctly
- [ ] Code blocks with various languages detected (go, python, javascript, c++, c#, f#, objective-c)
- [ ] Code blocks without language identifier detected (empty language)

### Visual Highlighting
- [ ] Active code block shows purple border (#7C3AED)
- [ ] Border is visible and distinct
- [ ] Only one code block highlighted at a time
- [ ] Highlighting updates when navigating between blocks
- [ ] Highlighting persists when scrolling

### Navigation
- [ ] `[` key navigates to previous code block
- [ ] `]` key navigates to next code block
- [ ] Navigation wraps (from first to last, last to first)
- [ ] Viewport scrolls to show active code block
- [ ] Navigation works with multiple code blocks in review
- [ ] Navigation works with code blocks in chat responses
- [ ] Navigation works when code blocks span across review and chat

### Smart Yank
- [ ] `yb` yanks the currently highlighted code block
- [ ] Yanked content is correct (no ANSI codes, just code)
- [ ] Falls back to last code block if none highlighted
- [ ] Works for code blocks in review response
- [ ] Works for code blocks in chat responses
- [ ] Visual feedback shows "✓ Copied code block to clipboard!"

### Contextual Hints
- [ ] Footer shows code block navigation hint when block is active
- [ ] Hint shows correct block number (e.g., "Block 2/5")
- [ ] Hint disappears when no code block is active

---

## 2. Chat Enhancements

### Request Cancellation
- [ ] `Ctrl+X` cancels streaming request during initial review
- [ ] `Ctrl+X` cancels streaming request during chat response
- [ ] Partial response is retained after cancellation
- [ ] "Request cancelled" feedback message appears
- [ ] Can continue chatting after cancellation
- [ ] New requests work after cancellation

### Prompt History
- [ ] `Ctrl+P` navigates to previous prompt in chat mode
- [ ] `Ctrl+N` navigates to next prompt in chat mode
- [ ] History wraps correctly (from first to last, last to first)
- [ ] Prompts saved when sent with `Alt+Enter`
- [ ] History persists across chat sessions in same review
- [ ] Empty prompt clears textarea when navigating beyond last
- [ ] Can edit and resend prompts from history

---

## 3. Preset Management

### Preset List
- [x] `revcli preset list` shows all built-in presets
- [x] Presets display with descriptions
- [x] Empty custom preset directory handled gracefully
- [x] `revcli preset list` shows all custom presets
- [x] Built-in and custom presets are clearly separated

### Preset Create
- [x] `revcli preset create <name>` creates preset interactively
- [x] Required name, show error when no name is provided
- [x] Duplicate preset names rejected
- [x] File saved to `~/.config/revcli/presets/<lowercase-name>.yaml`
- [x] Preset created with name, description, and prompt
- [x] Directory created if it doesn't exist
- [x] Success message displayed
- [x] Preset name normalized to lowercase
- [ ] Invalid YAML handled gracefully
#### [BUGS]
- [x] **Bug #01:**  The `preset create` command fails when users enter multi-word descriptions because fmt.Scanln() only reads up to the first whitespace. 
### Preset Delete
- [x] `revcli preset delete <name>` deletes custom preset
- [x] Built-in presets cannot be deleted (error message)
- [x] Confirmation prompt works (y/N)
- [x] File removed from filesystem
- [x] Success message displayed
- [x] Case-insensitive deletion works
- [x] Non-existent preset shows error
### Preset Show
- [x] `revcli preset show <name>` displays preset details
- [x] Shows name, description, and prompt
- [x] Works for built-in presets
- [x] Works for custom presets
- [x] Case-insensitive lookup works
- [x] Non-existent preset shows error
#### [BUGS]
- [x] **Bugs #02**
	- Recommend preset: Can not list custom presets when mistype
	- Recommend feature: Implement fuzzy matching when mistyping  
### Preset Edit
- [x] `revcli preset edit <name>` edits custom preset interactively
- [x] Can edit name, description, and prompt
- [x] Preset file updated after editing
- [x] Built-in presets cannot be edited (error message)
- [x] Non-existent preset shows error
- [ ] Shows current values as defaults when editing
- [ ] Duplicate name validation when renaming preset
- [ ] Preset file renamed if name changed
#### [BUGS]

### Preset Open
- [x] `revcli preset open <name>` opens preset file in editor
- [x] Uses `$EDITOR` environment variable
- [x] `revcli preset open` (no args) opens preset directory in file manager
- [x] Non-existent preset shows error + fuzzy find
- [ ] Falls back to `vi` if `$EDITOR` not set
- [ ] Linux: uses `xdg-open`
- [ ] macOS: uses `open`
- [ ] Windows: uses `explorer`
- [ ] Built-in presets show appropriate error message

### Preset Path
- [x] `revcli preset path <name>` shows preset file path
- [x] `revcli preset path` (no args) shows preset directory path
- [x] Paths are correct and accessible
- [x] Built-in presets show appropriate message
- [x] Non-existent preset shows error

### Preset Default
- [x] `revcli preset default <name>` sets default preset
- [x] `revcli preset default` shows current default preset
- [x] `revcli preset default --unset` clears default preset
- [x] Default preset saved to `~/.config/revcli/config.yaml`
- [x] Config file created if it doesn't exist
- [x] `--preset` flag overrides default preset
- [x] Default preset loads automatically in `review` command when `--preset` not provided
- [ ] Invalid default preset handled gracefully (preset deleted but still in config)

### Preset Replace Mode
- [x] `revcli review --preset <name> --preset-replace` replaces base prompt
- [x] `revcli review -p <name> -R` works as short alias
- [x] `revcli review -h` shows `--preset-replace` flag in help
- [ ] Preset YAML with `replace: true` replaces base prompt
- [x] Preset YAML with `replace: false` appends to base prompt (default)
- [x] `--preset-replace` flag overrides preset YAML `replace` field
- [x] Mode indicator shows "[mode: replace]" or "[mode: append]" in review output
- [x] Replace mode works with custom presets
- [x] Replace mode works with built-in presets
- [x] Replace mode works with default preset

### Preset System Prompt
- [x] `revcli preset system show` displays current system prompt
- [x] Shows custom prompt if exists, otherwise shows default
- [ ] `revcli preset system edit` allows editing system prompt
- [ ] Custom system prompt saved to `~/.config/revcli/presets/system.yaml`
- [ ] `revcli preset system reset` restores default system prompt
- [ ] Custom system prompt loads automatically in review command
- [ ] Default system prompt used when custom doesn't exist

### Preset Usage
- [x] `revcli review --preset <name>` uses preset correctly
- [x] Custom presets work in review command
- [x] Built-in presets work in review command
- [x] Case-insensitive preset names work
- [ ] Default preset loads automatically when `--preset` not specified
- [ ] `--preset` flag overrides default preset

---

## 4. Regression Testing

### Existing Features
- [ ] Short flag aliases work (`-s`, `-b`, `-m`, `-f`, `-i`, `-I`, `-k`, `-p`, `-v`)
- [ ] Vim navigation works (`j/k`, `g/G`, `Ctrl+d/u/f/b`)
- [ ] Search works (`/`, `n/N`, `Tab` toggle)
- [ ] Help overlay works (`?` key)
- [ ] Yank commands work (`y`, `Y`, `yb`)
- [ ] Chat mode works (`Enter` to enter, `Alt+Enter` to send)
- [ ] Review presets work (`--preset` flag)

### Bug Fixes Verification
- [ ] **Bug 1 Fixed:** Code block line numbers match viewport (test with review + chat)
- [ ] **Bug 2 Fixed:** Languages with special chars detected (`c++`, `c#`, `f#`, `objective-c`)
- [ ] **Bug 3 Fixed:** Preset case sensitivity works (create `MyPreset`, delete `mypreset`)

---

## 5. Edge Cases & Error Handling

### Code Blocks
- [ ] Empty code blocks handled
- [ ] Code blocks with only whitespace handled
- [ ] Very long code blocks handled
- [ ] Code blocks with special characters handled
- [ ] Nested code blocks (if possible in markdown) handled
- [ ] Code blocks at end of content handled
- [ ] Code blocks at start of content handled

### Chat
- [ ] Very long prompts handled
- [ ] Empty prompts rejected
- [ ] Special characters in prompts handled
- [ ] Multiple rapid cancellations handled
- [ ] History with many prompts handled

### Presets
- [ ] Very long preset names handled
- [ ] Preset names with special characters handled
- [ ] Very long preset prompts handled
- [ ] Missing preset directory handled
- [ ] Corrupted preset YAML handled
- [ ] Permissions issues handled

---

## 6. UI/UX Testing

### Visual
- [ ] Code block border is visible in various terminal themes
- [ ] Border doesn't break layout
- [ ] Footer hints are readable
- [ ] Help overlay displays correctly
- [ ] No visual glitches when navigating

### Performance
- [ ] Large reviews with many code blocks perform well
- [ ] Navigation is smooth
- [ ] No lag when highlighting code blocks
- [ ] Rendering is fast

### Accessibility
- [ ] All features accessible via keyboard
- [ ] Help overlay shows all keybindings
- [ ] Error messages are clear
- [ ] Success messages are clear

---

## 7. Cross-Platform (if applicable)

- [ ] Works on Linux
- [ ] Works on macOS (if applicable)
- [ ] Works on Windows (if applicable)
- [ ] Terminal compatibility verified

---

## Test Results Summary

**Total Tests:** [Number]
**Passed:** [Number]
**Failed:** [Number]
**Blocked:** [Number]

**Overall Status:** [Pass / Fail / Needs Work]

**Notes:**
[Any additional observations or recommendations]

---

## New Issues:
> **NOTES:** Issues relating to this current version 

#rv-is-preset
- [x] **IS01**  : In `~/.config/revcli/presets/` : Do not have custom presets, user can't edit custom presets
  - **Fixed:** Added `revcli preset edit <name>` command
- [x] **IS02** Missing feature: let user edit preset in command line or edit file manually 
  - **Fixed:** Added `revcli preset edit` command and `revcli preset open` command for manual editing
- [x] **IS03:** Missing feature: open preset folder/file
  - **Fixed:** Added `revcli preset open` (opens in editor/file manager) and `revcli preset path` (shows path) commands
- [x] **IS04** Missing feature: set default preset
  - **Fixed:** Added `revcli preset default` command and config.yaml support for default preset
- [x] **IS05**: Preset got overriden by system prompt 
  - **Fixed:** Added `replace` field to preset YAML and `--preset-replace` flag to review command
	1. ✅ Allow presets to optionally replace (not append to) the base prompt
	2. ✅ Add a flag like --preset-replace to completely override the base prompt
	3. ⏳ Allow user to modify system prompt (Future feature)

**|START| Preset REPLACE mode**
- [x] **IS06** No helper found when run `rv review -h`
  - **Fixed:** Added `--preset-replace` flag to help examples in command Long description
- [x] **IS07** Flag is too long, not great for typing (Need to be verified)
  - **Fixed:** Added short alias `-R` for `--preset-replace` flag using `BoolVarP`
**|END|Preset REPLACE mode**

- [x] **IS08** Missing feature: edit system prompt --> treat it as a custom preset file
  - **Fixed:** Added `preset system` command with `show/edit/reset` subcommands. System prompt can be customized via `~/.config/revcli/presets/system.yaml` 

- [ ] IS: Fail to edit when enter a different name (Consider disable edit *name*)
- [ ] IS: Not enter default value when editing (still show default value, so not a big deal)
- [ ] IS: Can not move cursor up and down when edit *prompt* (verify with create/edit)

## New Features 
> **NOTES:** These features maybe implemented in this phase or be noted in later release if note too much relevant to current version

#rv-feat-preset
- [ ] **FT01**: preset cp
- [ ] **FT02**: Interactive preset management:
	- [ ] `preset manage` : Open a panel which users can (create, edit, delete, cp, choose default, go) interactively (Is it possible ?) --> Later releases
- [ ] **FT03**: Able to change preset in follow-up questions
- [ ] **FT04**: Able to change language (Vietnamese, English,...)
- [ ] **FT05:** Programming languages presets
- [ ] **FT06:** Auto create custom presets + system prompt as files, allow user to treat them like a custom presets (remove the definition of built-in preset) 
- [ ] **FT07:** Refactor preset feature --> Merge preset system + custom presets + built-in presets --> Treat all as presets, but with diffrent type one subcommand, only.
	- Make the preset.go file shorter
	- Make less commands for preset management